import{f as C,e as l,j as e,n as S,o as A,p as I,q as P,t as B,v as w,w as F,r as p,x as g,y as L,z as D,A as _,C as k,D as G,E as T}from"./index-HkL_h2W0.js";import{B as f}from"./Button-g7ijUQUT.js";import{C as o,F as a}from"./Form-Biz91x59.js";import{R as x}from"./Row-BwJ34-YU.js";import{s as O,C as d,F as R}from"./index-D1usguXa.js";import{s as z,a as H}from"./selectors-CUuJO7hx.js";const U=({product:s})=>{const t=C(),c=l(O).find(n=>n.id===s.shop_id),m=n=>{t(S({...s,quantity:Number(n)}))},h=()=>{t(A(s.id))};return e.jsxs(d,{children:[e.jsxs(x,{children:[e.jsx(o,{xs:4,children:e.jsx(d.Img,{style:{height:"150px",objectFit:"contain"},src:s.product.image})}),e.jsx(o,{children:e.jsxs(d.Body,{className:"ps-0",children:[e.jsx(d.Title,{className:"me-5",children:s.product.name}),e.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[e.jsxs("span",{className:"flex-grow-1",children:[e.jsx("b",{children:"Price: "})," ",s.price," UAH"]}),e.jsx("b",{children:"Quantity: "}),e.jsx(a.Control,{style:{width:"100px"},type:"number",min:0,value:s.quantity,onChange:n=>m(n.target.value)})]}),e.jsxs(d.Text,{children:[e.jsx("b",{children:"Shop: "}),c&&c.name]})]})})]}),e.jsx(f,{className:"position-absolute",style:{top:"0.3rem",right:"0.2rem"},type:"button",variant:"link",onClick:h,title:"Delete",children:e.jsx(R,{size:24,color:"red"})})]})},Q=()=>{const s=C(),t=l(I),j=l(z),c=l(H),m=l(P),h=l(B),n=l(w),b=l(F),[y,N]=p.useState(0),v=()=>t.reduce((r,u)=>r+u.quantity*u.price,0);p.useEffect(()=>{N(v())},[t]),p.useEffect(()=>{c&&g.error("Something happened, please reload the page!")},[c]);const E=async r=>{r.preventDefault();const u=t.filter(i=>i.quantity!==0),q={name:m,email:h,phone:n,address:b,orderProducts:u.map(i=>({shop_id:i.shop_id,product_id:i.product_id,quantity:i.quantity,price:i.price}))};await s(G(q)).unwrap(),s(T()),g.success("Your order has been shipped!")};return e.jsx("section",{className:"border p-3",children:e.jsxs(a,{onSubmit:E,children:[e.jsxs(x,{children:[e.jsxs(o,{md:4,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicName",children:[e.jsx(a.Label,{children:"Name"}),e.jsx(a.Control,{type:"text",placeholder:"Enter name",onChange:r=>s(L(r.target.value)),value:m,required:!0})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e.jsx(a.Label,{children:"Email address"}),e.jsx(a.Control,{type:"email",placeholder:"Enter email",onChange:r=>s(D(r.target.value)),value:h,required:!0})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicPhone",children:[e.jsx(a.Label,{children:"Phone"}),e.jsx(a.Control,{type:"text",placeholder:"Enter phone",onChange:r=>s(_(r.target.value)),value:n,required:!0})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicAddress",children:[e.jsx(a.Label,{children:"Address"}),e.jsx(a.Control,{type:"text",placeholder:"Enter address",onChange:r=>s(k(r.target.value)),value:b,required:!0})]})]}),e.jsx(o,{className:"mb-3",children:e.jsx(x,{className:"g-3",children:t.map(r=>e.jsx(o,{xs:12,children:e.jsx(U,{product:r})},r.id))})})]}),e.jsxs(x,{children:[e.jsxs(o,{children:[e.jsx("b",{children:"Sum:"})," ",y," UAH"]}),e.jsx(o,{children:e.jsx(f,{className:"d-block ms-auto",variant:"primary",type:"submit",disabled:j||t.length===0,children:"Submit"})})]})]})})},X=()=>e.jsx("main",{children:e.jsx(Q,{})});export{X as default};
