import{r as n,P as N,j as s,c as p,u as x,f as A,e as C,i as te,k as re,l as oe,n as ne,o as le,p as ce,q as ie,t as q,v as de,w as me,x as he,y as pe,z as ue,A as xe}from"./index-DzL2Twsz.js";import{C as g,s as je,b,R as $,B,F as fe}from"./index-DX3oRO-L.js";function Fe(e,a){return n.Children.toArray(e).some(t=>n.isValidElement(t)&&t.type===a)}const ye={type:N.string,tooltip:N.bool,as:N.elementType},R=n.forwardRef(({as:e="div",className:a,type:t="valid",tooltip:r=!1,...o},l)=>s.jsx(e,{...o,ref:l,className:p(a,`${t}-${r?"tooltip":"feedback"}`)}));R.displayName="Feedback";R.propTypes=ye;const G=R,Ce=n.createContext({}),j=Ce,O=n.forwardRef(({id:e,bsPrefix:a,className:t,type:r="checkbox",isValid:o=!1,isInvalid:l=!1,as:c="input",...h},u)=>{const{controlId:d}=n.useContext(j);return a=x(a,"form-check-input"),s.jsx(c,{...h,ref:u,type:r,id:e||d,className:p(t,a,o&&"is-valid",l&&"is-invalid")})});O.displayName="FormCheckInput";const D=O,_=n.forwardRef(({bsPrefix:e,className:a,htmlFor:t,...r},o)=>{const{controlId:l}=n.useContext(j);return e=x(e,"form-check-label"),s.jsx("label",{...r,ref:o,htmlFor:t||l,className:p(a,e)})});_.displayName="FormCheckLabel";const L=_,z=n.forwardRef(({id:e,bsPrefix:a,bsSwitchPrefix:t,inline:r=!1,reverse:o=!1,disabled:l=!1,isValid:c=!1,isInvalid:h=!1,feedbackTooltip:u=!1,feedback:d,feedbackType:f,className:v,style:i,title:F="",type:y="checkbox",label:k,children:I,as:Z="input",...P},ee)=>{a=x(a,"form-check"),t=x(t,"form-switch");const{controlId:T}=n.useContext(j),se=n.useMemo(()=>({controlId:e||T}),[T,e]),E=!I&&k!=null&&k!==!1||Fe(I,L),ae=s.jsx(D,{...P,type:y==="switch"?"checkbox":y,ref:ee,isValid:c,isInvalid:h,disabled:l,as:Z});return s.jsx(j.Provider,{value:se,children:s.jsx("div",{style:i,className:p(v,E&&a,r&&`${a}-inline`,o&&`${a}-reverse`,y==="switch"&&t),children:I||s.jsxs(s.Fragment,{children:[ae,E&&s.jsx(L,{title:F,children:k}),d&&s.jsx(G,{type:f,tooltip:u,children:d})]})})})});z.displayName="FormCheck";const w=Object.assign(z,{Input:D,Label:L}),H=n.forwardRef(({bsPrefix:e,type:a,size:t,htmlSize:r,id:o,className:l,isValid:c=!1,isInvalid:h=!1,plaintext:u,readOnly:d,as:f="input",...v},i)=>{const{controlId:F}=n.useContext(j);return e=x(e,"form-control"),s.jsx(f,{...v,type:a,size:r,ref:i,readOnly:d,id:o||F,className:p(l,u?`${e}-plaintext`:e,t&&`${e}-${t}`,a==="color"&&`${e}-color`,c&&"is-valid",h&&"is-invalid")})});H.displayName="FormControl";const ge=Object.assign(H,{Feedback:G}),M=n.forwardRef(({className:e,bsPrefix:a,as:t="div",...r},o)=>(a=x(a,"form-floating"),s.jsx(t,{ref:o,className:p(e,a),...r})));M.displayName="FormFloating";const Ne=M,U=n.forwardRef(({controlId:e,as:a="div",...t},r)=>{const o=n.useMemo(()=>({controlId:e}),[e]);return s.jsx(j.Provider,{value:o,children:s.jsx(a,{...t,ref:r})})});U.displayName="FormGroup";const V=U,Q=n.forwardRef(({as:e="label",bsPrefix:a,column:t=!1,visuallyHidden:r=!1,className:o,htmlFor:l,...c},h)=>{const{controlId:u}=n.useContext(j);a=x(a,"form-label");let d="col-form-label";typeof t=="string"&&(d=`${d} ${d}-${t}`);const f=p(o,a,r&&"visually-hidden",t&&d);return l=l||u,t?s.jsx(g,{ref:h,as:"label",className:f,htmlFor:l,...c}):s.jsx(e,{ref:h,className:f,htmlFor:l,...c})});Q.displayName="FormLabel";const ve=Q,Y=n.forwardRef(({bsPrefix:e,className:a,id:t,...r},o)=>{const{controlId:l}=n.useContext(j);return e=x(e,"form-range"),s.jsx("input",{...r,type:"range",ref:o,className:p(a,e),id:t||l})});Y.displayName="FormRange";const be=Y,J=n.forwardRef(({bsPrefix:e,size:a,htmlSize:t,className:r,isValid:o=!1,isInvalid:l=!1,id:c,...h},u)=>{const{controlId:d}=n.useContext(j);return e=x(e,"form-select"),s.jsx("select",{...h,size:t,ref:u,className:p(r,e,a&&`${e}-${a}`,o&&"is-valid",l&&"is-invalid"),id:c||d})});J.displayName="FormSelect";const $e=J,K=n.forwardRef(({bsPrefix:e,className:a,as:t="small",muted:r,...o},l)=>(e=x(e,"form-text"),s.jsx(t,{...o,ref:l,className:p(a,e,r&&"text-muted")})));K.displayName="FormText";const we=K,W=n.forwardRef((e,a)=>s.jsx(w,{...e,ref:a,type:"switch"}));W.displayName="Switch";const ke=Object.assign(W,{Input:w.Input,Label:w.Label}),X=n.forwardRef(({bsPrefix:e,className:a,children:t,controlId:r,label:o,...l},c)=>(e=x(e,"form-floating"),s.jsxs(V,{ref:c,className:p(a,e),controlId:r,...l,children:[t,s.jsx("label",{htmlFor:r,children:o})]})));X.displayName="FloatingLabel";const Ie=X,Le={_ref:N.any,validated:N.bool,as:N.elementType},S=n.forwardRef(({className:e,validated:a,as:t="form",...r},o)=>s.jsx(t,{...r,ref:o,className:p(e,a&&"was-validated")}));S.displayName="Form";S.propTypes=Le;const m=Object.assign(S,{Group:V,Control:ge,Floating:Ne,Check:w,Switch:ke,Label:ve,Text:we,Range:be,Select:$e,FloatingLabel:Ie}),Re=({product:e})=>{const a=A(),r=C(je).find(c=>c.id===e.shop_id),o=c=>{a(te({...e,quantity:Number(c)}))},l=()=>{a(re(e.id))};return s.jsxs(b,{children:[s.jsxs($,{children:[s.jsx(g,{xs:4,children:s.jsx(b.Img,{style:{height:"150px",objectFit:"contain"},src:e.product.image})}),s.jsx(g,{children:s.jsxs(b.Body,{className:"ps-0",children:[s.jsx(b.Title,{className:"me-5",children:e.product.name}),s.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[s.jsxs("span",{className:"flex-grow-1",children:[s.jsx("b",{children:"Price: "})," ",e.price," UAH"]}),s.jsx("b",{children:"Quantity: "}),s.jsx(m.Control,{style:{width:"100px"},type:"number",min:0,value:e.quantity,onChange:c=>o(c.target.value)})]}),s.jsxs(b.Text,{children:[s.jsx("b",{children:"Shop: "}),r&&r.name]})]})})]}),s.jsx(B,{className:"position-absolute",style:{top:"0.3rem",right:"0.2rem"},type:"button",variant:"link",onClick:l,title:"Delete",children:s.jsx(fe,{size:24,color:"red"})})]})},Se=e=>e.orders.error,Te=e=>e.orders.isLoading,Ee=()=>{const e=A(),a=C(oe),t=C(Te),r=C(Se),o=C(ne),l=C(le),c=C(ce),h=C(ie),[u,d]=n.useState(0),f=()=>a.reduce((i,F)=>i+F.quantity*F.price,0);n.useEffect(()=>{d(f())},[a]),n.useEffect(()=>{r&&q.error("Something happened, please reload the page!")},[r]);const v=async i=>{i.preventDefault();const F={name:o,email:l,phone:c,address:h,orderProducts:a.map(y=>({shop_id:y.id,product_id:y.id,quantity:y.quantity,price:y.price}))};await e(ue(F)).unwrap(),e(xe()),q.success("Your order has been shipped!")};return s.jsx("section",{className:"border p-3",children:s.jsxs(m,{onSubmit:v,children:[s.jsxs($,{children:[s.jsxs(g,{md:4,children:[s.jsxs(m.Group,{className:"mb-3",controlId:"formBasicName",children:[s.jsx(m.Label,{children:"Name"}),s.jsx(m.Control,{type:"text",placeholder:"Enter name",onChange:i=>e(de(i.target.value)),value:o,required:!0})]}),s.jsxs(m.Group,{className:"mb-3",controlId:"formBasicEmail",children:[s.jsx(m.Label,{children:"Email address"}),s.jsx(m.Control,{type:"email",placeholder:"Enter email",onChange:i=>e(me(i.target.value)),value:l,required:!0})]}),s.jsxs(m.Group,{className:"mb-3",controlId:"formBasicPhone",children:[s.jsx(m.Label,{children:"Phone"}),s.jsx(m.Control,{type:"text",placeholder:"Enter phone",onChange:i=>e(he(i.target.value)),value:c,required:!0})]}),s.jsxs(m.Group,{className:"mb-3",controlId:"formBasicAddress",children:[s.jsx(m.Label,{children:"Address"}),s.jsx(m.Control,{type:"text",placeholder:"Enter address",onChange:i=>e(pe(i.target.value)),value:h,required:!0})]})]}),s.jsx(g,{className:"mb-3",children:s.jsx($,{className:"g-3",children:a.map(i=>s.jsx(g,{xs:12,children:s.jsx(Re,{product:i})},i.id))})})]}),s.jsxs($,{children:[s.jsxs(g,{children:[s.jsx("b",{children:"Sum:"})," ",u," UAH"]}),s.jsx(g,{children:s.jsx(B,{className:"d-block ms-auto",variant:"primary",type:"submit",disabled:t||a.length===0,children:"Submit"})})]})]})})},Be=()=>s.jsx("main",{children:s.jsx(Ee,{})});export{Be as default};
