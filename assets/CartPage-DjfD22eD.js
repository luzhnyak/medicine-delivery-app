import{f as C,e as l,j as e,n as S,o as q,p as A,q as I,t as B,v as P,w as F,r as p,x as g,y as w,z as L,A as D,C as _,D as k,E as G}from"./index-Cic6S9aV.js";import{C as o,B as f}from"./Col-YtlSGuay.js";import{F as a}from"./Form-Dl6DrzCz.js";import{s as T,C as c,R as x,F as O}from"./index-CF1QEAxg.js";import{s as R,a as z}from"./selectors-CUuJO7hx.js";const H=({product:s})=>{const t=C(),i=l(T).find(n=>n.id===s.shop_id),d=n=>{t(S({...s,quantity:Number(n)}))},m=()=>{t(q(s.id))};return e.jsxs(c,{children:[e.jsxs(x,{children:[e.jsx(o,{xs:4,children:e.jsx(c.Img,{style:{height:"150px",objectFit:"contain"},src:s.product.image})}),e.jsx(o,{children:e.jsxs(c.Body,{className:"ps-0",children:[e.jsx(c.Title,{className:"me-5",children:s.product.name}),e.jsxs("div",{className:"d-flex gap-3 align-items-center",children:[e.jsxs("span",{className:"flex-grow-1",children:[e.jsx("b",{children:"Price: "})," ",s.price," UAH"]}),e.jsx("b",{children:"Quantity: "}),e.jsx(a.Control,{style:{width:"100px"},type:"number",min:0,value:s.quantity,onChange:n=>d(n.target.value)})]}),e.jsxs(c.Text,{children:[e.jsx("b",{children:"Shop: "}),i&&i.name]})]})})]}),e.jsx(f,{className:"position-absolute",style:{top:"0.3rem",right:"0.2rem"},type:"button",variant:"link",onClick:m,title:"Delete",children:e.jsx(O,{size:24,color:"red"})})]})},U=()=>{const s=C(),t=l(A),j=l(R),i=l(z),d=l(I),m=l(B),n=l(P),b=l(F),[y,N]=p.useState(0),v=()=>t.reduce((r,h)=>r+h.quantity*h.price,0);p.useEffect(()=>{N(v())},[t]),p.useEffect(()=>{i&&g.error("Something happened, please reload the page!")},[i]);const E=async r=>{r.preventDefault();const h={name:d,email:m,phone:n,address:b,orderProducts:t.map(u=>({shop_id:u.shop_id,product_id:u.product_id,quantity:u.quantity,price:u.price}))};await s(k(h)).unwrap(),s(G()),g.success("Your order has been shipped!")};return e.jsx("section",{className:"border p-3",children:e.jsxs(a,{onSubmit:E,children:[e.jsxs(x,{children:[e.jsxs(o,{md:4,children:[e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicName",children:[e.jsx(a.Label,{children:"Name"}),e.jsx(a.Control,{type:"text",placeholder:"Enter name",onChange:r=>s(w(r.target.value)),value:d,required:!0})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[e.jsx(a.Label,{children:"Email address"}),e.jsx(a.Control,{type:"email",placeholder:"Enter email",onChange:r=>s(L(r.target.value)),value:m,required:!0})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicPhone",children:[e.jsx(a.Label,{children:"Phone"}),e.jsx(a.Control,{type:"text",placeholder:"Enter phone",onChange:r=>s(D(r.target.value)),value:n,required:!0})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formBasicAddress",children:[e.jsx(a.Label,{children:"Address"}),e.jsx(a.Control,{type:"text",placeholder:"Enter address",onChange:r=>s(_(r.target.value)),value:b,required:!0})]})]}),e.jsx(o,{className:"mb-3",children:e.jsx(x,{className:"g-3",children:t.map(r=>e.jsx(o,{xs:12,children:e.jsx(H,{product:r})},r.id))})})]}),e.jsxs(x,{children:[e.jsxs(o,{children:[e.jsx("b",{children:"Sum:"})," ",y," UAH"]}),e.jsx(o,{children:e.jsx(f,{className:"d-block ms-auto",variant:"primary",type:"submit",disabled:j||t.length===0,children:"Submit"})})]})]})})},V=()=>e.jsx("main",{children:e.jsx(U,{})});export{V as default};
